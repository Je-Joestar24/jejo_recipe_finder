import{i as S,m as D,n as B,p as $,q as C,s as U,v as N,d as p,x as w,c as d,a as r,y as _,z as v,f as a,A as b,o as u,B as H,g as x,e as y,t as V,w as L,l as f,k as T}from"./index-CZYvMulo.js";const c=S("profile",()=>{const i=D(),{showMessage:o}=B(),n=$(!1),l=$(!1),s=C({name:"",email:""}),t=C({currentPassword:"",newPassword:""}),e=C({name:"",email:""}),m=U(()=>s.name!==e.name||s.email!==e.email||l.value&&t.newPassword.length>0),h=()=>{i.logged_user&&(s.name=i.logged_user.name,s.email=i.logged_user.email,e.name=i.logged_user.name,e.email=i.logged_user.email)},z=()=>{n.value?E():(n.value=!0,l.value=!1,g())},k=()=>{l.value=!l.value,l.value||g()},g=()=>{t.currentPassword="",t.newPassword=""},E=()=>{n.value=!1,l.value=!1,g(),i.logged_user&&(s.name=e.name,s.email=e.email)},M=async()=>{if(i.logged_user)try{if(l.value&&t.newPassword.length>0){if(t.currentPassword!==i.logged_user.password){o("Current password is incorrect");return}if(t.newPassword.length<6){o("New password must be at least 6 characters long");return}}const P={...i.logged_user,name:s.name,email:s.email,password:l.value&&t.newPassword.length>0?t.newPassword:i.logged_user.password};await i.updateUserProfile(P),e.name=s.name,e.email=s.email,n.value=!1,l.value=!1,g(),o("Profile updated successfully!")}catch(P){console.error("Error updating profile:",P),o("Failed to update profile. Please try again.")}};return h(),N(()=>i.logged_user,()=>{h()},{immediate:!0}),{isEditing:n,showPasswordChange:l,profileData:s,passwordData:t,originalData:e,hasChanges:m,initializeProfile:h,toggleEdit:z,togglePasswordChange:k,resetPasswordData:g,cancelEdit:E,saveProfile:M}}),F={class:"form-group"},R=["disabled"],Y=p({__name:"username",setup(i){const{isEditing:o,profileData:n}=w(c());return(l,s)=>(u(),d("div",F,[s[1]||(s[1]=r("label",{for:"username",class:"form-label"},"Username",-1)),_(r("input",{id:"username","onUpdate:modelValue":s[0]||(s[0]=t=>a(n).name=t),type:"text",class:b(["form-input",{editing:a(o)}]),disabled:!a(o),"aria-describedby":"username-help"},null,10,R),[[v,a(n).name]]),s[2]||(s[2]=r("div",{id:"username-help",class:"form-help"},"Your display name",-1))]))}}),q={class:"form-group"},A=["disabled"],J=p({__name:"email",setup(i){const{isEditing:o,profileData:n}=w(c());return(l,s)=>(u(),d("div",q,[s[1]||(s[1]=r("label",{for:"email",class:"form-label"},"Email",-1)),_(r("input",{id:"email","onUpdate:modelValue":s[0]||(s[0]=t=>a(n).email=t),type:"email",class:b(["form-input",{editing:a(o)}]),disabled:!a(o),"aria-describedby":"email-help"},null,10,A),[[v,a(n).email]]),s[2]||(s[2]=r("div",{id:"email-help",class:"form-help"},"Your email address",-1))]))}}),j={class:"password-section"},G={key:0,class:"password-form"},I={class:"form-group"},K={class:"form-group"},O=p({__name:"password",setup(i){const{togglePasswordChange:o}=c(),{isEditing:n,passwordData:l,showPasswordChange:s}=w(c());return(t,e)=>_((u(),d("div",j,[r("button",{onClick:e[0]||(e[0]=(...m)=>a(o)&&a(o)(...m)),type:"button",class:b(["change-password-btn",{active:a(s)}]),"aria-label":"Change password"},[e[3]||(e[3]=r("svg",{class:"lock-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9V6zm9 14H6V10h12v10z"})],-1)),y(" "+V(a(s)?"Cancel Password Change":"Change Password"),1)],2),a(s)?(u(),d("div",G,[r("div",I,[e[4]||(e[4]=r("label",{for:"currentPassword",class:"form-label"},"Current Password",-1)),_(r("input",{id:"currentPassword","onUpdate:modelValue":e[1]||(e[1]=m=>a(l).currentPassword=m),type:"password",class:"form-input",placeholder:"Enter current password","aria-describedby":"current-password-help"},null,512),[[v,a(l).currentPassword]]),e[5]||(e[5]=r("div",{id:"current-password-help",class:"form-help"},"Enter your current password",-1))]),r("div",K,[e[6]||(e[6]=r("label",{for:"newPassword",class:"form-label"},"New Password",-1)),_(r("input",{id:"newPassword","onUpdate:modelValue":e[2]||(e[2]=m=>a(l).newPassword=m),type:"password",class:"form-input",placeholder:"Enter new password","aria-describedby":"new-password-help"},null,512),[[v,a(l).newPassword]]),e[7]||(e[7]=r("div",{id:"new-password-help",class:"form-help"},"Enter your new password",-1))])])):x("",!0)],512)),[[H,a(n)]])}}),Q={key:0,class:"form-actions"},W=["disabled"],X=p({__name:"actions",setup(i){const{cancelEdit:o}=c(),{hasChanges:n,isEditing:l}=w(c());return(s,t)=>a(l)?(u(),d("div",Q,[r("button",{type:"button",onClick:t[0]||(t[0]=(...e)=>a(o)&&a(o)(...e)),class:"btn btn-secondary","aria-label":"Cancel changes"}," Cancel "),r("button",{type:"submit",class:"btn btn-primary",disabled:!a(n),"aria-label":"Save profile changes"},t[1]||(t[1]=[r("svg",{class:"save-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"})],-1),y(" Save Changes ",-1)]),8,W)])):x("",!0)}}),Z=p({__name:"form",setup(i){const{saveProfile:o}=c(),{isEditing:n,profileData:l}=w(c());return(s,t)=>(u(),d("form",{onSubmit:t[0]||(t[0]=L((...e)=>a(o)&&a(o)(...e),["prevent"])),class:"profile-form"},[f(Y),f(J),f(O),f(X)],32))}}),ss={class:"profile-header"},es={class:"profile-actions"},as=["aria-label"],rs={key:0,class:"edit-icon",viewBox:"0 0 24 24",fill:"currentColor"},os={key:1,class:"close-icon",viewBox:"0 0 24 24",fill:"currentColor"},ts=p({__name:"header",setup(i){const{toggleEdit:o}=c(),{isEditing:n}=w(c());return(l,s)=>(u(),d("div",ss,[s[3]||(s[3]=r("div",{class:"avatar-section"},[r("div",{class:"avatar-circle"},[r("svg",{class:"user-icon",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})])])],-1)),r("div",es,[r("button",{onClick:s[0]||(s[0]=(...t)=>a(o)&&a(o)(...t)),class:b(["edit-btn",{active:a(n)}]),"aria-label":a(n)?"Cancel editing":"Edit profile"},[a(n)?(u(),d("svg",os,s[2]||(s[2]=[r("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"},null,-1)]))):(u(),d("svg",rs,s[1]||(s[1]=[r("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"},null,-1)]))),y(" "+V(a(n)?"Cancel":"Edit"),1)],10,as)])]))}}),ns={class:"profile-card"},ls=p({__name:"container",setup(i){return(o,n)=>(u(),d("div",ns,[f(ts),f(Z)]))}}),is={class:"profile-container"},us=p({__name:"ProfileView",setup(i){return T(()=>document.title="JRF | Profile"),(o,n)=>(u(),d("div",is,[f(ls)]))}});export{us as default};
